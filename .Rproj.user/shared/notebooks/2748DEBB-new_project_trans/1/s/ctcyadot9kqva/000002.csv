"0","## Select only continuous variables"
"0","linearity <- my_data %>% "
"0","  "
"0","  select(where(is.numeric), -mfiid, -year, -prbonds, -dummy, -count)"
"0",""
"0","## Select names of the numeric predictors"
"0","predictors <- names(linearity)"
"0",""
"0","## Predict from the model"
"0","probabilities <- predict(logit_full, type = ""response"")"
"0",""
"0","predicted.classes <- ifelse(probabilities > 0.5, ""others"", ""NGO"") %>% "
"0","  "
"0","  factor(levels = levels(my_data %>% select(currentlegaldummy)))"
"0",""
"0","# Bind the logit and tidying the data for plot"
"0","linearity <- linearity %>%"
"0","  mutate(logit = log(probabilities/(1-probabilities))) %>%"
"0","  gather(key = ""predictors"", value = ""predictor.value"", -logit)"
"0",""
"0","ggplot(linearity, aes(logit, predictor.value))+"
"0","  geom_point(size = 0.5, alpha = 0.5) +"
"0","  geom_smooth(method = ""loess"") + "
"0","  theme_bw() + "
"0","  facet_wrap(~predictors, scales = ""free_y"") + "
"0","  ggtitle("""")"
