"0","## Read in the dataset "
"0","my_data <- read_csv(""amelia.csv"") %>% "
"0",""
"0","## Region"
"0","mutate(region = if_else(region == ""Middle East and North Africa"", "
"0","                        "
"0","                        ""North_Africa"", region)) %>% "
"0",""
"0","# Clean the names "
"0","janitor::clean_names() %>% "
"0","  "
"0","# Set up factor variables "
"0","## legal status "
"0","mutate(currentlegalstatus = factor(currentlegalstatus, "
"0","                           levels = c(""NGO"", ""Bank"", ""NBFI"", "
"0","                            ""Credit Union/ Cooperative"", "
"0","                            ""Rural Bank"")), "
"0","      ## Age"
"0","      age = factor(age, levels = c(""New"", ""Young"", ""Mature"")),"
"0","       "
"0","      ## Region "
"0","      region = factor(region, levels = c(""North_Africa"", ""Africa""))) %>% "
"0","  "
"0","      ## Add the financial structure data     "
"0","      left_join(finstr, by = c(""country"", ""year"")) %>% "
"0","  "
"0","      ## Add a binary variable for the legal dummy- NGO vs Others"
"0","      mutate(currentlegaldummy = case_when(currentlegalstatus == ""NGO"" ~ ""NGO"","
"0","                                           "
"0","                                           TRUE ~ ""others""),"
"0","      "
"0","        currentlegaldummy = factor(currentlegaldummy, levels = c(""NGO"", ""others"")),"
"0","        "
"0","        legal_tradition = factor(legal_tradition, "
"0","                                 "
"0","                                 levels = c(""Common"", ""Civil"", ""Other""))) %>% "
"0","  ## Select required variables "
"0","  select(mfiid, mfiname, year, country, currentlegaldummy, currentlegalstatus, "
"0","         "
"0","         age, legal_tradition, region.x, asset_structure, "
"0","         "
"0","         assets, kkm, education, pcrdbgdp, stmktcap, prbonds, gdp_growth_annual) %>% "
"0","  "
"0","          ## Rename region"
"0","         rename(region = region.x) %>% "
"0","  "
"0","  group_by(country) %>% "
"0","  "
"0","  mutate(kkm = replace_na(kkm, median(kkm, na.rm = TRUE)),"
"0","         education = replace_na(education, median(education, na.rm = TRUE)),"
"0","         prbonds = replace_na(prbonds, median(prbonds, na.rm = TRUE)),"
"0","         pcrdbgdp = replace_na(pcrdbgdp, median(pcrdbgdp, na.rm = TRUE)),"
"0","         stmktcap = replace_na(stmktcap, median(stmktcap, na.rm = TRUE))) %>% "
"0","  "
"0","  ungroup() %>% "
"0","  "
"0","  group_by(mfiid) %>% "
"0","  "
"0","  mutate(asset_structure = replace_na(asset_structure, median(asset_structure, na.rm = TRUE)), assets = replace_na(assets, median(assets, na.rm = TRUE))) %>% "
"0","  "
"0","  ungroup() %>% "
"0","  "
"0","  group_by(region) %>% "
"0","  "
"0","  mutate(education = replace_na(education, median(education, na.rm = TRUE)),"
"0","         "
"0","         kkm = replace_na(kkm, median(kkm, na.rm = TRUE)),"
"0","         "
"0","         gdp_growth_annual = replace_na(gdp_growth_annual, "
"0","                                        "
"0","         median(gdp_growth_annual, na.rm = TRUE))) %>% "
"0","  "
"0","  ungroup() %>% "
"0","  "
"0","  group_by(currentlegalstatus) %>% "
"0","  "
"0","  mutate(assets = replace_na(assets, median(assets, na.rm = TRUE))) %>% "
"0","  "
"0","  ungroup() %>% "
"0","  "
"0","  mutate(dummy = if_else(currentlegaldummy == ""NGO"", 0, 1)) %>% "
"0","  "
"0","  mutate(assets = log(assets + 1),"
"0","         "
"0","         pcrdbgdp = log(pcrdbgdp + 1),"
"0","         "
"0","         stmktcap = log(stmktcap + 1),"
"0","         "
"0","         prbonds = log(prbonds + 1)) %>% "
"0","  "
"0","  select(-asset_structure) %>% "
"0","  "
"0","  add_count(mfiid, name = ""count"") %>% "
"0","  "
"0","  mutate(currentlegalstatus = fct_recode(currentlegalstatus, Coop = ""Credit Union/ Cooperative""))"
"1","
[36mâ”€â”€[39m [1m[1mColumn specification[1m[22m [36mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
cols(
  .default = col_double(),
  mfiname = [31mcol_character()[39m,
  region = [31mcol_character()[39m,
  country = [31mcol_character()[39m,
  currentlegalstatus = [31mcol_character()[39m,
  outreach = [31mcol_character()[39m,
  age = [31mcol_character()[39m,
  period_type = [31mcol_character()[39m,
  currency = [31mcol_character()[39m,
  as_of_date = [31mcol_character()[39m,
  profit.status = [31mcol_character()[39m,
  sustainability = [31mcol_character()[39m,
  legal_tradition = [31mcol_character()[39m
)
[36mâ„¹[39m Use [38;5;251m[48;5;235m[38;5;251m[48;5;235m`spec()`[48;5;235m[38;5;251m[49m[39m for the full column specifications.

"
"0","  "
"0","## Write a csv for the data"
"0","my_data %>% write.csv(., ""data.csv"")"
"0",""
"0","## Visualize missing data"
"0","#md.pattern(data)"
"0","## Amelia::missmap(data)"
"0",""
"0","## MFIs with three (3) or more years of data"
"0","data3 <- my_data %>% "
"0","  "
"0","  group_by(mfiid) %>% "
"0","  "
"0","  filter(n() > 3)"
"0","  "
"0","data3 %>% write.csv(., ""data3.csv"")"
"0",""
"0","## MFIs with three (3) or more years of data"
"0","data5 <- my_data %>% "
"0","  "
"0","  group_by(mfiid) %>% "
"0","  "
"0","  filter(n() > 5)  "
"0","  "
"0","data5 %>% write.csv(., ""data5.csv"")"
